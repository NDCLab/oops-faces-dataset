
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This script was created by George Buzzell for the NDC Lab EEG Training
% Workshop on 02/22. This script uses parts of the "set up" structure from
% the MADE preprocessing pipeline (Debnath, Buzzell, et. al., 2020)

clear % clear matlab workspace
clc % clear matlab command window

%% setup; run this section before any other section below

% main directory
main_dir = '/home/data/NDClab/datasets/oops-faces-dataset';

% Setting up other things

%Location of MADE and ADJUSTED-ADJUST scripts
addpath(genpath([main_dir filesep 'code' filesep 'eeg' filesep 'MADE-EEG-preprocessing-pipeline']));% enter the path of the folder in this line

%Location of eeglab
addpath(genpath([main_dir filesep 'code' filesep 'eeg' filesep 'eeglab13_4_4b']));% enter the path of the EEGLAB folder in this line

%remove path to octave functions inside matlab to prevent errors when
rmpath([main_dir filesep 'code' filesep 'eeg' filesep 'eeglab13_4_4b' filesep 'functions' filesep 'octavefunc' filesep 'signal'])

% 1. Enter the path of the folder that has the data to be analyzed
data_location = [main_dir filesep 'derivatives' filesep 'eeg' filesep 'preprocessed' filesep 'processed_data'];

% 2. Enter the path of the folder where you want to save the processed data
output_location = [main_dir filesep 'derivatives' filesep 'eeg' filesep 'eeg_erp_output'];

% 3. Enter the path of the channel location file
channel_locations = [main_dir filesep 'code' filesep 'eeg' filesep 'MADE-EEG-preprocessing-pipeline' filesep 'chan_locs_files' filesep 'CACS-128-X7-FIXED-64only.bvef'];

% enter the stimulus makers that need to be adjusted for time offset
stimulus_markers = {'S  3', 'S  4', 'S  5', 'S  6', 'S  7', 'S  8', 'S 13', 'S 14', 'S 15', 'S 16', 'S 17', 'S 18'};      % enter the stimulus makers that need to be adjusted for time offset
response_markers = {'S 11', 'S 12', 'S 21', 'S 22'};

% Read files to analyses
datafile_names=dir([data_location filesep '*.set']);
datafile_names=datafile_names(~ismember({datafile_names.name},{'.', '..', '.DS_Store'}));
datafile_names={datafile_names.name};
[filepath,name,ext] = fileparts(char(datafile_names{1}));

% Check whether EEGLAB and all necessary plugins are in Matlab path.
if exist('eeglab','file')==0
    error(['Please make sure EEGLAB is on your Matlab path. Please see EEGLAB' ...
        'wiki page for download and instalation instructions']);
end

%% Count trials

% switch to output directory
cd(output_location);

for subject=1:length(datafile_names)
    EEG=[];
    
    fprintf('\n\n\n*** Processing subject %d (%s) ***\n\n\n', subject, datafile_names{subject});
    
    %load in raw data that is alread in eeglab (.set) format)
    EEG = pop_loadset( 'filename', datafile_names{subject}, 'filepath', data_location);
    EEG = eeg_checkset(EEG);
    
    %remove all the non-stim-locking markers (should have done already...)
    EEG = pop_selectevent( EEG, 'latency','-.1 <= .1','deleteevents','on');
	EEG = eeg_checkset( EEG );
    
    %count how many of each event type (combination of event types) of
    %interest are present

    preanger-anger-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp([EEG.event.target] == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)   ));
    preanger-happy-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    prehappy-happy-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1) & ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));

    preanger-anger-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp([EEG.event.target] == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)   ));
    preanger-happy-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    prehappy-happy-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'resp') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0) & ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    
    preanger-anger-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp([EEG.event.target] == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)   ));
    preanger-happy-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    prehappy-happy-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-diff-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-diff-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-same-corr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 1)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-same-err= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 1) & ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));

    preanger-anger-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp([EEG.event.target] == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-anger-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-anger-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    preanger-happy-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)   ));
    preanger-happy-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    preanger-happy-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    preanger-happy-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'a') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)));
    prehappy-happy-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1)& ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-happy-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-happy-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'h') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-prediff-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 'd') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-diff-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-diff-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 'd') & ([EEG.event.accuracy] == 0)  & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    prehappy-anger-presame-same-corr-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 1) & ([EEG.event.prevAccuracy] == 0)& ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1)  ));
    prehappy-anger-presame-same-err-prevErr= length(find( strcmp({EEG.event.eventType} == 'stim') & strcmp({EEG.event.emotion} == 'h') & strcmp({EEG.event.prevEmotion} == 'a') & strcmp({EEG.event.prevTarget} == 's') & strcmp({EEG.event.target} == 's') & ([EEG.event.accuracy] == 0) & ([EEG.event.prevAccuracy] == 0) & ([EEG.event.validTrial] == 1) & ([EEG.event.prevValidTrial]==1) ));
    

    %create trial counts table for trial counts
    counts_table= table({datafile_names{subject}}, {preanger-anger-prediff-diff-corr}, {preanger-anger-prediff-diff-err}, {preanger-anger-prediff-same-corr}, {preanger-anger-prediff-same-err}, ...
                        {preanger-anger-presame-diff-corr}, {preanger-anger-presame-diff-err}, {preanger-anger-presame-same-corr}, {preanger-anger-presame-same-err}, {preanger-happy-prediff-diff-corr}, ...
                        {preanger-happy-prediff-diff-err}, {preanger-happy-prediff-same-corr}, {preanger-happy-prediff-same-err}, {preanger-happy-presame-diff-corr}, {preanger-happy-presame-diff-err}, ...
                        {preanger-happy-presame-same-corr}, {preanger-happy-presame-same-err}, {prehappy-happy-prediff-diff-corr}, {prehappy-happy-prediff-diff-err}, {prehappy-happy-prediff-same-corr}, ...
                        {prehappy-happy-prediff-same-err}, {prehappy-happy-presame-diff-corr}, {prehappy-happy-presame-diff-err}, {prehappy-happy-presame-same-corr}, {prehappy-happy-presame-same-err}, ...
                        {prehappy-anger-prediff-diff-corr}, {prehappy-anger-prediff-diff-err}, {prehappy-anger-prediff-same-corr}, {prehappy-anger-prediff-same-err}, {prehappy-anger-presame-diff-corr}, ...
                        {prehappy-anger-presame-diff-err}, {prehappy-anger-presame-same-corr}, {prehappy-anger-presame-same-err}, {preanger-anger-prediff-diff-corr-prevErr}, {preanger-anger-prediff-diff-err-prevErr}, ...
                        {preanger-anger-prediff-same-corr-prevErr}, {preanger-anger-prediff-same-err-prevErr}, {preanger-anger-presame-diff-corr-prevErr}, {preanger-anger-presame-diff-err-prevErr}, {preanger-anger-presame-same-corr-prevErr}, ...
                        {preanger-anger-presame-same-err-prevErr}, {preanger-happy-prediff-diff-corr-prevErr},{preanger-happy-prediff-diff-err-prevErr}, {preanger-happy-prediff-same-corr-prevErr}, {preanger-happy-prediff-same-err-prevErr}, ...
                        {preanger-happy-presame-diff-corr-prevErr}, {preanger-happy-presame-diff-err-prevErr},{preanger-happy-presame-same-corr-prevErr}, {preanger-happy-presame-same-err-prevErr}, {prehappy-happy-prediff-diff-corr-prevErr}, ...
                        {prehappy-happy-prediff-diff-err-prevErr}, {prehappy-happy-prediff-same-corr-prevErr}, {prehappy-happy-prediff-same-err-prevErr}, {prehappy-happy-presame-diff-corr-prevErr}, {prehappy-happy-presame-diff-err-prevErr}, ...
                        {prehappy-happy-presame-same-corr-prevErr}, {prehappy-happy-presame-same-err-prevErr},{prehappy-anger-prediff-diff-corr-prevErr}, {prehappy-anger-prediff-diff-err-prevErr}, {prehappy-anger-prediff-same-corr-prevErr}, ...
                        {prehappy-anger-prediff-same-err-prevErr}, {prehappy-anger-presame-diff-corr-prevErr},{prehappy-anger-presame-diff-err-prevErr}, {prehappy-anger-presame-same-corr-prevErr}, {prehappy-anger-presame-same-err-prevErr}, ...
                        {preanger-anger-prediff-diff-corr_stim}, {preanger-anger-prediff-diff-err_stim}, {preanger-anger-prediff-same-corr_stim}, {preanger-anger-prediff-same-err_stim}, ...
                        {preanger-anger-presame-diff-corr_stim}, {preanger-anger-presame-diff-err_stim}, {preanger-anger-presame-same-corr_stim}, {preanger-anger-presame-same-err_stim}, {preanger-happy-prediff-diff-corr_stim}, ...
                        {preanger-happy-prediff-diff-err_stim}, {preanger-happy-prediff-same-corr_stim}, {preanger-happy-prediff-same-err_stim}, {preanger-happy-presame-diff-corr_stim}, {preanger-happy-presame-diff-err_stim}, ...
                        {preanger-happy-presame-same-corr_stim}, {preanger-happy-presame-same-err_stim}, {prehappy-happy-prediff-diff-corr_stim}, {prehappy-happy-prediff-diff-err_stim}, {prehappy-happy-prediff-same-corr_stim}, ...
                        {prehappy-happy-prediff-same-err_stim}, {prehappy-happy-presame-diff-corr_stim}, {prehappy-happy-presame-diff-err_stim}, {prehappy-happy-presame-same-corr_stim}, {prehappy-happy-presame-same-err_stim}, ...
                        {prehappy-anger-prediff-diff-corr_stim}, {prehappy-anger-prediff-diff-err_stim}, {prehappy-anger-prediff-same-corr_stim}, {prehappy-anger-prediff-same-err_stim}, {prehappy-anger-presame-diff-corr_stim}, ...
                        {prehappy-anger-presame-diff-err_stim}, {prehappy-anger-presame-same-corr_stim}, {prehappy-anger-presame-same-err_stim}, {preanger-anger-prediff-diff-corr-prevErr_stim}, {preanger-anger-prediff-diff-err-prevErr_stim}, ...
                        {preanger-anger-prediff-same-corr-prevErr_stim}, {preanger-anger-prediff-same-err-prevErr_stim}, {preanger-anger-presame-diff-corr-prevErr_stim}, {preanger-anger-presame-diff-err-prevErr_stim}, {preanger-anger-presame-same-corr-prevErr_stim}, ...
                        {preanger-anger-presame-same-err-prevErr_stim}, {preanger-happy-prediff-diff-corr-prevErr_stim},{preanger-happy-prediff-diff-err-prevErr_stim}, {preanger-happy-prediff-same-corr-prevErr_stim}, {preanger-happy-prediff-same-err-prevErr_stim}, ...
                        {preanger-happy-presame-diff-corr-prevErr_stim}, {preanger-happy-presame-diff-err-prevErr_stim},{preanger-happy-presame-same-corr-prevErr_stim}, {preanger-happy-presame-same-err-prevErr_stim}, {prehappy-happy-prediff-diff-corr-prevErr_stim}, ...
                        {prehappy-happy-prediff-diff-err-prevErr_stim}, {prehappy-happy-prediff-same-corr-prevErr_stim}, {prehappy-happy-prediff-same-err-prevErr_stim}, {prehappy-happy-presame-diff-corr-prevErr_stim}, {prehappy-happy-presame-diff-err-prevErr_stim}, ...
                        {prehappy-happy-presame-same-corr-prevErr_stim}, {prehappy-happy-presame-same-err-prevErr_stim},{prehappy-anger-prediff-diff-corr-prevErr_stim}, {prehappy-anger-prediff-diff-err-prevErr_stim}, {prehappy-anger-prediff-same-corr-prevErr_stim}, ...
                        {prehappy-anger-prediff-same-err-prevErr_stim}, {prehappy-anger-presame-diff-corr-prevErr_stim},{prehappy-anger-presame-diff-err-prevErr_stim}, {prehappy-anger-presame-same-corr-prevErr_stim}, {prehappy-anger-presame-same-err-prevErr_stim});
    %create variable names for count trials output and write to dis
    counts_table.Properties.VariableNames = {'fileName', 'preanger-anger-prediff-diff-corr', 'preanger-anger-prediff-diff-err', 'preanger-anger-prediff-same-corr', 'preanger-anger-prediff-same-err', ...
                                            'preanger-anger-presame-diff-corr', 'preanger-anger-presame-diff-err', 'preanger-anger-presame-same-corr', 'preanger-anger-presame-same-err', ...
                                            'preanger-happy-prediff-diff-corr', 'preanger-happy-prediff-diff-err', 'preanger-happy-prediff-same-corr', 'preanger-happy-prediff-same-err', ...
                                            'preanger-happy-presame-diff-corr', 'preanger-happy-presame-diff-err', 'preanger-happy-presame-same-corr', 'preanger-happy-presame-same-err', ...
                                            'prehappy-happy-prediff-diff-corr', 'prehappy-happy-prediff-diff-err', 'prehappy-happy-prediff-same-corr', 'prehappy-happy-prediff-same-err', ...
                                            'prehappy-happy-presame-diff-corr', 'prehappy-happy-presame-diff-err', 'prehappy-happy-presame-same-corr', 'prehappy-happy-presame-same-err', ...
                                            'prehappy-anger-prediff-diff-corr', 'prehappy-anger-prediff-diff-err', 'prehappy-anger-prediff-same-corr', 'prehappy-anger-prediff-same-err', ...
                                            'prehappy-anger-presame-diff-corr', 'prehappy-anger-presame-diff-err', 'prehappy-anger-presame-same-corr', 'prehappy-anger-presame-same-err', ...
                                            'preanger-anger-prediff-diff-corr-prevErr', 'preanger-anger-prediff-diff-err-prevErr', 'preanger-anger-prediff-same-corr-prevErr', 'preanger-anger-prediff-same-err-prevErr', ...
                                            'preanger-anger-presame-diff-corr-prevErr', 'preanger-anger-presame-diff-err-prevErr', 'preanger-anger-presame-same-corr-prevErr', 'preanger-anger-presame-same-err-prevErr', ...
                                            'preanger-happy-prediff-diff-corr-prevErr', 'preanger-happy-prediff-diff-err-prevErr', 'preanger-happy-prediff-same-corr-prevErr', 'preanger-happy-prediff-same-err-prevErr', ...
                                            'preanger-happy-presame-diff-corr-prevErr', 'preanger-happy-presame-diff-err-prevErr', 'preanger-happy-presame-same-corr-prevErr', 'preanger-happy-presame-same-err-prevErr', ...
                                            'prehappy-happy-prediff-diff-corr-prevErr', 'prehappy-happy-prediff-diff-err-prevErr', 'prehappy-happy-prediff-same-corr-prevErr', 'prehappy-happy-prediff-same-err-prevErr', ...
                                            'prehappy-happy-presame-diff-corr-prevErr', 'prehappy-happy-presame-diff-err-prevErr', 'prehappy-happy-presame-same-corr-prevErr', 'prehappy-happy-presame-same-err-prevErr', ...
                                            'prehappy-anger-prediff-diff-corr-prevErr', 'prehappy-anger-prediff-diff-err-prevErr', 'prehappy-anger-prediff-same-corr-prevErr', 'prehappy-anger-prediff-same-err-prevErr', ...
                                            'prehappy-anger-presame-diff-corr-prevErr', 'prehappy-anger-presame-diff-err-prevErr', 'prehappy-anger-presame-same-corr-prevErr', 'prehappy-anger-presame-same-err-prevErr', ...
                                            'preanger-anger-prediff-diff-corr_stim', 'preanger-anger-prediff-diff-err_stim', 'preanger-anger-prediff-same-corr_stim', 'preanger-anger-prediff-same-err_stim', ...
                                            'preanger-anger-presame-diff-corr_stim', 'preanger-anger-presame-diff-err_stim', 'preanger-anger-presame-same-corr_stim', 'preanger-anger-presame-same-err_stim', ...
                                            'preanger-happy-prediff-diff-corr_stim', 'preanger-happy-prediff-diff-err_stim', 'preanger-happy-prediff-same-corr_stim', 'preanger-happy-prediff-same-err_stim', ...
                                            'preanger-happy-presame-diff-corr_stim', 'preanger-happy-presame-diff-err_stim', 'preanger-happy-presame-same-corr_stim', 'preanger-happy-presame-same-err_stim', ...
                                            'prehappy-happy-prediff-diff-corr_stim', 'prehappy-happy-prediff-diff-err_stim', 'prehappy-happy-prediff-same-corr_stim', 'prehappy-happy-prediff-same-err_stim', ...
                                            'prehappy-happy-presame-diff-corr_stim', 'prehappy-happy-presame-diff-err_stim', 'prehappy-happy-presame-same-corr_stim', 'prehappy-happy-presame-same-err_stim', ...
                                            'prehappy-anger-prediff-diff-corr_stim', 'prehappy-anger-prediff-diff-err_stim', 'prehappy-anger-prediff-same-corr_stim', 'prehappy-anger-prediff-same-err_stim', ...
                                            'prehappy-anger-presame-diff-corr_stim', 'prehappy-anger-presame-diff-err_stim', 'prehappy-anger-presame-same-corr_stim', 'prehappy-anger-presame-same-err_stim', ...
                                            'preanger-anger-prediff-diff-corr-prevErr_stim', 'preanger-anger-prediff-diff-err-prevErr_stim', 'preanger-anger-prediff-same-corr-prevErr_stim', 'preanger-anger-prediff-same-err-prevErr_stim', ...
                                            'preanger-anger-presame-diff-corr-prevErr_stim', 'preanger-anger-presame-diff-err-prevErr_stim', 'preanger-anger-presame-same-corr-prevErr_stim', 'preanger-anger-presame-same-err-prevErr_stim', ...
                                            'preanger-happy-prediff-diff-corr-prevErr_stim', 'preanger-happy-prediff-diff-err-prevErr_stim', 'preanger-happy-prediff-same-corr-prevErr_stim', 'preanger-happy-prediff-same-err-prevErr_stim', ...
                                            'preanger-happy-presame-diff-corr-prevErr_stim', 'preanger-happy-presame-diff-err-prevErr_stim', 'preanger-happy-presame-same-corr-prevErr_stim', 'preanger-happy-presame-same-err-prevErr_stim', ...
                                            'prehappy-happy-prediff-diff-corr-prevErr_stim', 'prehappy-happy-prediff-diff-err-prevErr_stim', 'prehappy-happy-prediff-same-corr-prevErr_stim', 'prehappy-happy-prediff-same-err-prevErr_stim', ...
                                            'prehappy-happy-presame-diff-corr-prevErr_stim', 'prehappy-happy-presame-diff-err-prevErr_stim', 'prehappy-happy-presame-same-corr-prevErr_stim', 'prehappy-happy-presame-same-err-prevErr_stim', ...
                                            'prehappy-anger-prediff-diff-corr-prevErr_stim', 'prehappy-anger-prediff-diff-err-prevErr_stim', 'prehappy-anger-prediff-same-corr-prevErr_stim', 'prehappy-anger-prediff-same-err-prevErr_stim', ...
                                            'prehappy-anger-presame-diff-corr-prevErr_stim', 'prehappy-anger-presame-diff-err-prevErr_stim', 'prehappy-anger-presame-same-corr-prevErr_stim', 'prehappy-anger-presame-same-err-prevErr_stim'};

    %write to disk the trial counts for this participant
    writetable(counts_table, [output_location filesep 'oops_faces_trial_counts.csv'], "WriteMode", "append");
end
